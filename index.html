<script>
const synth = window.speechSynthesis;
let voices = [];

function loadVoices() {
  voices = synth.getVoices();
  voiceSelect.innerHTML = '';
  voices.forEach((voice, i) => {
    if (voice.lang.includes('ar')) {
      const option = document.createElement('option');
      option.value = i;
      option.textContent = voice.name + ' - ' + voice.lang;
      voiceSelect.appendChild(option);
    }
  });
}

window.onload = () => {
  loadVoices();
  if (speechSynthesis.onvoiceschanged !== undefined) {
    speechSynthesis.onvoiceschanged = loadVoices;
  }
};

function speak() {
  synth.cancel();
  const text = document.getElementById('text').value;
  if (!text) return alert('اكتب نص أولاً');

  const utterance = new SpeechSynthesisUtterance(text);
  utterance.voice = voices[voiceSelect.value] || null;
  utterance.lang = 'ar-SA';
  utterance.rate = rate.value;
  utterance.pitch = pitch.value;

  synth.speak(utterance);
}

function stopSpeech() {
  synth.cancel();
}
      </script>
